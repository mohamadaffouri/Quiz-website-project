<!DOCTYPE html>
   <html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
      <link rel="stylesheet" href="assets/css/styles.css">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>      <title></title>
      <style>
       
      </style>
   </head>
   <body>
      <nav class="navbar navbar-expand-lg  pg-transparen fixed-top navbar">
         <div class="container-fluid">
             <a class="navbar-brand fs-4" href="#">QuizZes</a>
             <button class="navbar-toggler shadow-non border-0" type="button" data-bs-toggle="offcanvas"
                     data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                 <span class="navbar-toggler-icon"></span>
             </button>
             <div class="sidebar offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar"
                  aria-labelledby="offcanvasNavbarLabel">
                 <div class="offcanvas-header text-white border-bottom ">
                     <h5 class="offcanvas-title" id="offcanvasNavbarLabel">QuizZes</h5>
                     <button type="button" class="btn-close btn-close-white shadow-non" data-bs-dismiss="offcanvas"
                             aria-label="Close"></button>
                 </div>
                 <div class="offcanvas-body ">
                     <ul class="navbar-nav justify-content-center fs-5 flex-grow-1 pe-3 ">
                         <li class="nav-item">
                             <a class="nav-link active" aria-current="page" href="/mainPage/test.html#FAhome">Home</a>
                         </li>
                         <li class="nav-item mx-2">
                             <a class="nav-link" href="/mainPage/test.html#AS_aboutuslink">About</a>
                         </li>
                         <li class="nav-item mx-2">
                             <a class="nav-link" href="/mainPage/test.html#quizSessions">Our Quizzes</a>
                         </li>
                         <li class="nav-item mx-2">
                             <a class="nav-link" href="/mainPage/test.html#AS_Contactlink">contact</a>
                         </li>
                     </ul>
                    
                 </div>
             </div>
         </div>
       </nav>


      <div class="login " style="height: 100vh;">
        
         <img src="https://images.unsplash.com/photo-1531973576160-7125cd663d86?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="login image" class="login_img">
         <form action="" class="login__form" onsubmit="validateForm(event)">
            <h1 class="login__title">Login</h1>

            <div class="login__content">
               <div class="login__box">
                  <i class="ri-mail-line login__icon"></i>

                  <div class="login__box-input">
                     <input type="email"  class="login__input" id="login-email" placeholder=" ">
                     <label for="login-email" class="login__label">Email</label>
                  </div>
                 
               </div>
               <div id="errorEmail" class="error"></div>
               <div class="login__box">
                  <i class="ri-lock-2-line login__icon"></i>

                  <div class="login__box-input">
                     <input type="password"  class="login__input" id="login-pass" placeholder=" ">
                     <label for="login-pass" class="login__label">Password</label>
                     <i class="ri-eye-off-line login__eye" id="login-eye-pass" onclick="togglePassword('login-pass', 'login-eye-pass')"></i>
                  </div>
               </div>
               <div id="errorPass" class="error"></div>
            </div>

            <div class="login__check">
               <div class="login__check-group">
                  <input type="checkbox" class="login__check-input" id="login-check">
                  <label for="login-check" class="login__check-label">Remember me</label>
               </div>

               <a href="#" class="login__forgot">Forgot Password?</a>
            </div>

            <button type="submit" class="login__button">Login</button>

            <p class="login__register">
               Don't have an account? <a href="registration.html">Register</a>
            </p>
         </form>
      </div>
      
      <!--=============== MAIN JS ===============-->
      <script >

const quizSubject = sessionStorage.getItem("quizValu");

if(quizSubject !=null && quizSubject !="" ){
 
} else window.location.href = "/mainPage/test.html"; 
   

         function validateEmail(e){
        event.preventDefault();
       // sessionStorage.removeItem('loginEmail');
        var email =document.getElementById("login-email").value;
    var errorDiv=document.getElementById("errorEmail");
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if(regex.test(email)){
        sessionStorage.setItem("loginEmail", email);
        errorDiv.style.display = 'none';
        errorDiv.textContent = "";
       
    } else {
        errorDiv.textContent = "Please enter a valid email address.";
        errorDiv.style.display = 'block';
                errorDiv.style.color = "red";
    }
  
    }

    function validatePassword (e){
       
        event.preventDefault();
        
      //  sessionStorage.removeItem('loginPassword');
        var password =document.getElementById("login-pass").value;
    var errorDiv=document.getElementById("errorPass");
    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
    if(regex.test(password)){
        sessionStorage.setItem("loginPassword", password);
        errorDiv.style.display = 'none';
        errorDiv.textContent = "";
        
    } else {
        errorDiv.textContent = "Password must be 8+ chars with 1 uppercase, 1 lowercase, 1 digit, and 1 special character.";
        errorDiv.style.display = 'block';
                errorDiv.style.color = "red";
    }

    }
    function validateForm(e){
        validatePassword(e);
        validateEmail(e);
        // عشان يروح على صفحه الكويز 
        const loginEmail = sessionStorage.getItem("loginEmail");
        const savedEmail = localStorage.getItem('savedEmail');
        const loginPassword = sessionStorage.getItem("loginPassword");
        const password = localStorage.getItem('password');
        var users = JSON.parse(localStorage.getItem("users")) || [];
        var user = users.find(user => user.email === loginEmail && user.password === loginPassword );
        if (user){
         console.log(user.userName);
         var userName=user.userName;
         sessionStorage.setItem("userName", userName);
         window.location.href = '/quizPage/Quiz-website/quizInstructions.html';
        } else alert("User Not found");
       
     }
     // عشان يخلي الباسورد يبين و يختفي 
     function togglePassword(inputId, iconId) {
         var passwordInput = document.getElementById(inputId);
         var icon = document.getElementById(iconId);
         if (passwordInput.type === "password") {
             passwordInput.type = "text";
             icon.classList.remove("ri-eye-off-line");
             icon.classList.add("ri-eye-line");
         } else {
             passwordInput.type = "password";
             icon.classList.remove("ri-eye-line");
             icon.classList.add("ri-eye-off-line");
         }
      }
      </script>
   </body>
</html>